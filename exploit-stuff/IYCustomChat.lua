if CUSTOM_CHAT then
	error("Custom Chat is already running!")
	return
end

pcall(function() getgenv().CUSTOM_CHAT  = true end)
repeat wait() until game:IsLoaded()
repeat wait() until game:GetService("CoreGui"):WaitForChild("TopBar")

local Players = game:GetService("Players")

--wait(2.5)

game:GetService("StarterGui"):SetCore("SendNotification",{
    Title = "IYChat",
    Text = "Loaded",
    Duration = 5
})

local Secret_Key = 200
local IYC = {}
local Blocked = {}
local LP = Players.LocalPlayer
LP.OsPlatform = "IYCHAT_Running"

local Chat = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local ChatBarParentFrame = Instance.new("Frame")
local Frame_2 = Instance.new("Frame")
local BoxFrame = Instance.new("Frame")
local Frame_3 = Instance.new("Frame")
local ChatBar = Instance.new("TextBox")
local MessageMode = Instance.new("TextButton")
local TextLabel = Instance.new("TextLabel")
local ChannelsBarParentFrame = Instance.new("Frame")
local Frame_4 = Instance.new("Frame")
local ScrollingBase = Instance.new("Frame")
local ScrollerSizer = Instance.new("Frame")
local ScrollerFrame = Instance.new("Frame")
local Frame_All = Instance.new("Frame")
local BackgroundFrame = Instance.new("Frame")
local UnselectedFrame = Instance.new("Frame")
local TextButton = Instance.new("TextButton")
local SelectedFrame = Instance.new("Frame")
local BackgroundImage = Instance.new("ImageLabel")
local BlueBarLeft = Instance.new("ImageLabel")
local BlueBarRight = Instance.new("ImageLabel")
local TextButton_2 = Instance.new("TextButton")
local TextButton_3 = Instance.new("TextButton")
local Frame_5 = Instance.new("Frame")
local ImageLabel = Instance.new("ImageLabel")
local TextLabel_2 = Instance.new("TextLabel")
local Frame_System = Instance.new("Frame")
local BackgroundFrame_2 = Instance.new("Frame")
local UnselectedFrame_2 = Instance.new("Frame")
local TextButton_4 = Instance.new("TextButton")
local SelectedFrame_2 = Instance.new("Frame")
local BackgroundImage_2 = Instance.new("ImageLabel")
local BlueBarLeft_2 = Instance.new("ImageLabel")
local BlueBarRight_2 = Instance.new("ImageLabel")
local TextButton_5 = Instance.new("TextButton")
local TextButton_6 = Instance.new("TextButton")
local Frame_6 = Instance.new("Frame")
local ImageLabel_2 = Instance.new("ImageLabel")
local TextLabel_3 = Instance.new("TextLabel")
local Frame_7 = Instance.new("Frame")
local LeaveConfirmationFrame = Instance.new("Frame")
local TextButton_7 = Instance.new("TextButton")
local TextButton_8 = Instance.new("TextButton")
local TextButton_9 = Instance.new("TextButton")
local TextLabel_4 = Instance.new("TextLabel")
local PageLeftButton = Instance.new("ImageButton")
local ArrowLabel = Instance.new("ImageLabel")
local PositionalHelper = Instance.new("Frame")
local PageRightButton = Instance.new("ImageButton")
local ArrowLabel_2 = Instance.new("ImageLabel")
local ChatChannelParentFrame = Instance.new("Frame")
local Frame_MessageLogDisplay = Instance.new("Frame")
local Scroller = Instance.new("ScrollingFrame")
local UIListLayout = Instance.new("UIListLayout")
local Frame_8 = Instance.new("Frame")
local TextLabel_5 = Instance.new("TextLabel")
local ImageButton = Instance.new("ImageButton")
local ImageLabel_3 = Instance.new("ImageLabel")

function Match(str, with)
	local str, with = tostring(str), tostring(with)
	if (string.match(str, with) and true or false) then
		return true or false
	end
end

function SplitStr(str, div)
  local str, sep, div = tostring(str), {}, tostring(div)
  for i in str:gmatch("[^".. div .."]+") do
    table.insert(sep, i)
  end
  return sep
end

function IYEncrypt(Message, PluginKey)
	local Message, PluginKey, tab = tostring(Message), tonumber(PluginKey), {}
	for i = 0, 127 do 
		local a = -1 
		repeat a = a + 2 
		until a * (2 * i + 1) % 256 == 1 
		tab[i] = a
	end
	local Var1 = PluginKey
	local Var2 = PluginKey + PluginKey
	return (Message:gsub(".", function(Encode) 
		local Var3 = Var1 % 274877906944
		local Var4 = (Var1 - Var3) / 274877906944 
		local Var5 = Var4 % 128 
		Encode = Encode:byte() 
		local Var6 = (Encode * tab[Var5] - (Var4 - Var5) / 128) % 256
		Var1 = Var3 * Var2 + Var4 + Var6 + Encode
		return ('%02x'):format(Var6)
	end))
end

function IYDecrypt(Message, PluginKey)
	local Message, PluginKey = tostring(Message), tonumber(PluginKey)
	local Var1 = PluginKey
	local Var2 = PluginKey + PluginKey
	return(Message:gsub("%x%x", function(Decode) 
		local Var3 = Var1 % 274877906944
		local Var4 = (Var1 - Var3) / 274877906944 
		local Var5 = Var4 % 128 
		Decode = tonumber(Decode, 16) 
		local Var6 = (Decode + (Var4 - Var5) / 128) * (2 * Var5 + 1) % 256 
		Var1 = Var3 * Var2 + Var4 + Decode + Var6
		return string.char(Var6)
	end))
end
function GetPlayers(str)
  local str = tostring(str)
  local found = {}
  for i,v in pairs(Players:GetPlayers()) do
   if str == "me" then
      if v.Name == LP.Name then
        table.insert(found, v)
      end
    elseif v.Name:lower():sub(1, #str) == str:lower() then
      table.insert(found, v)
    end
  end
  if #found ~= 0 then
    return found else return false
  end
end
function GenMsg(str, PM, Target)
	local str, Target = tostring(str), tostring(Target):lower()
	if not PM then
		return "IYCHAT_"..IYEncrypt("Received|||||"..str, Secret_Key)
	else
		local Key = 0
		for i = 1, #Target do
			Key = Key + Target:sub(i, i):byte()
		end
		if PM and Target and Key then
			--local PMEncryption = "Private|||||"..IYEncrypt("Received|||||" .. str, Key)
			--return "IYCHAT_"..IYEncrypt(PMEncryption, Secret_Key)
			return Target.."_"..IYEncrypt("Private|||||"..str, Secret_Key)
		end
	end
end

function GetMsg(str, Username)
	local str, Username, Key = tostring(str), tostring(Username):lower(), 0
	for i = 1, #Username do
		Key = Key + Username:sub(i, i):byte()
	end
	if Match(str, "IYCHAT_") then
		str = str:gsub("IYCHAT_", "")
		str = IYDecrypt(str, Secret_Key)
		local split = SplitStr(str, "|||||")
		if #split > 1 then
			if split[1] == "Received" then
				return {split[2]; false}
			end
			--[[elseif split[1] == "Private" then
				local encmsg = IYDecrypt(split[2], Key)
				local split2 = SplitStr(encmsg, "|||||")
				if #split2 > 1 then
					if split2[1] == "Received" then
						return {split2[2]; true}
					end
				end
			end--]]
		end
	end
	if Match(str, Username.."_") then
		str = str:gsub(Username.."_", "")
		str = IYDecrypt(str, Secret_Key)
		local split = SplitStr(str, "|||||")
		if #split > 1 then
			if split[1] == "Private" then
				return {split[2]; true}
			end
		end
	end
	return false
end

function FindInTable(Table, Name)
	for i,v in pairs(Table) do
		if v == Name then
			return true
		end
	end
	return false
end

function GetInTable(Table, Name)
	for i = 1, #Table do
		if Table[i] == Name then
			return i
		end
	end
	return false
end

function CreateLabelC(Name, Text, IsDM)
	local sf = Scroller.Frame
	local sf2 = Scroller
	local alls = 20
	for i,v in pairs(sf:GetChildren()) do
		if v then
			alls = v.Size.Y.Offset + alls
		end
		if not v then
			alls = 0
		end
	end
	local tl = Instance.new('TextButton', sf)
	local il = Instance.new('Frame', tl)
	--local minWidth, minHeight = 10, 110
	tl.Name = Name
	tl.Text = Text
	tl.Size = UDim2.new(0,355,0,110)
	tl.BackgroundTransparency = 1
	tl.Font = Enum.Font.SourceSansBold
	tl.ClipsDescendants = true
	tl.Position = UDim2.new(0,8,0,alls)
	tl.TextTransparency = 1
	tl.TextScaled = false
	tl.TextSize = 18
	tl.TextWrapped = true
	tl.TextXAlignment = Enum.TextXAlignment.Left
	tl.TextYAlignment = Enum.TextYAlignment.Top
	tl.Selectable = true
	tl.MouseButton1Click:Connect(function()
		TextLabel.Visible = false
		ChatBar:CaptureFocus()
		wait()
		ChatBar.Text = ChatBar.Text.."@"..tl.Name
		ChatBar.CursorPosition = string.len(ChatBar.Text)+1
	end)
	il.BackgroundTransparency = 1
	il.BorderSizePixel = 0
	il.Size = UDim2.new(0,16,1,0)
	il.Position = UDim2.new(0,316,0,0)
	tl.TextStrokeTransparency = 0.750
	--tl.TextColor3 = Color3.fromRGB(255,255,255)
	tl.TextColor3 = (Name == LP.Name and Color3.fromRGB(255, 255, 255)) or (IsDM and Color3.fromRGB(249, 233, 153)) or Color3.fromRGB(255, 255, 255)
	--tl.Size = UDim2.new(1,-15,0,tl.TextBounds.Y)
	tl.Size = UDim2.new(0,355,0,tl.TextBounds.Y)
	--tl.Size = UDim2.new(0, math.max(minWidth, tl.TextBounds.X),0, math.max(minHeight, tl.TextBounds.Y))
	sf2.CanvasSize = UDim2.new(0,0,0,alls+tl.TextBounds.Y)
	--sf2.CanvasSize = UDim2.new(sf2.CanvasSize.X.Scale,sf2.CanvasSize.X.Offset,sf2.CanvasSize.Y.Scale,alls+tl.TextBounds.Y)
	sf2.CanvasPosition = Vector2.new(0,sf2.CanvasPosition.Y+tl.TextBounds.Y)
	local size2 = sf2.CanvasSize.Y.Offset
	tl.TextTransparency = 0
end

----------------------------------------------------------------------

local ChatIcon2 = Instance.new("TextButton")
local BadgeContainer2 = Instance.new("Frame")
local Badge2 = Instance.new("Frame")
local Inner2 = Instance.new("ImageLabel")
local TextLabel2 = Instance.new("TextLabel")
local Background2 = Instance.new("ImageLabel")
local Background_22 = Instance.new("ImageButton")
local Icon2 = Instance.new("ImageLabel")
local StateOverlay2 = Instance.new("ImageLabel")

----------------------------------------------------------------------

local PingContainer2 = Instance.new("Frame")
local Ping2 = Instance.new("Frame")
local PingInner2 = Instance.new("ImageLabel")
local PingTextLabel2 = Instance.new("TextLabel")
local PingBackground2 = Instance.new("ImageLabel")

----------------------------------------------------------------------

TMouse = game.Players.LocalPlayer:GetMouse()
TMouse.KeyDown:connect(
    function(Key)
        if (Key == "'") then
			if game:GetService("Players")[LP.Name].PlayerGui.Chat.Frame.Visible then
				game:GetService("Players")[LP.Name].PlayerGui.Chat.Frame.Visible = false
			end
            ChatBar:CaptureFocus()
            spawn(
                function()
                    repeat
                        ChatBar.Text = ""
                    until ChatBar.Text == ""
                end
            )
        --ChatBar.Text = ""
        --[[spawn(function()
repeat
TextLabel.Visible = false
Frame.Visible = true
ChatIcon2.ImageColor3 = Color3.new(0, 255, 0)
ChatChannelParentFrame.BackgroundTransparency = 0.6
ImageButton.BackgroundTransparency = 0.6
Frame_2.BackgroundTransparency = 0.6
BoxFrame.BackgroundTransparency = 0.6
TextLabel.TextTransparency = 0.4
ChatBar.TextTransparency = 0.4
until ChatBar.Text == ''
end)--]]
        end
    end
)

--Properties:

Chat.Name = "CustomChat"
Chat.Parent = game.Players[game.Players.LocalPlayer.Name].PlayerGui
Chat.DisplayOrder = 6
Chat.ResetOnSpawn = false

Frame.Parent = Chat
Frame.BackgroundTransparency = 1.000
Frame.Size = UDim2.new(0.300000012, 0, 0.275945932, 0)
--Frame.Position = UDim2.new(0, 0, 0.72, 0)
Frame.Visible = false

ChatBarParentFrame.Name = "ChatBarParentFrame"
ChatBarParentFrame.Parent = Frame
ChatBarParentFrame.BackgroundTransparency = 1.000
ChatBarParentFrame.Position = UDim2.new(0, 0, 1, -42)
ChatBarParentFrame.Size = UDim2.new(1, 0, 0, 42)

Frame_2.Parent = ChatBarParentFrame
Frame_2.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Frame_2.BackgroundTransparency = 1
Frame_2.BorderSizePixel = 0
Frame_2.Size = UDim2.new(1, 0, 1, 0)

BoxFrame.Name = "BoxFrame"
BoxFrame.Parent = Frame_2
BoxFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
BoxFrame.BackgroundTransparency = 1
BoxFrame.BorderSizePixel = 0
BoxFrame.Position = UDim2.new(0, 7, 0, 7)
BoxFrame.Size = UDim2.new(1, -14, 1, -14)

Frame_3.Parent = BoxFrame
Frame_3.BackgroundTransparency = 1.000
Frame_3.Position = UDim2.new(0, 5, 0, 5)
Frame_3.Size = UDim2.new(1, -10, 1, -10)

ChatBar.Name = "ChatBar"
ChatBar.Parent = Frame_3
ChatBar.BackgroundTransparency = 1.000
ChatBar.Selectable = false
ChatBar.Size = UDim2.new(0, 370, 0, 28)
--(1, 0, 1, 0)
ChatBar.ClearTextOnFocus = false
ChatBar.Font = Enum.Font.SourceSansBold
ChatBar.Text = ""
ChatBar.TextColor3 = Color3.fromRGB(0, 0, 0)
ChatBar.TextSize = 18.000
ChatBar.TextTransparency = 1
ChatBar.TextWrapped = true
ChatBar.TextScaled = false
ChatBar.TextXAlignment = Enum.TextXAlignment.Left
ChatBar.TextYAlignment = Enum.TextYAlignment.Top
ChatBar.MouseEnter:connect(
    function()
        ChatChannelParentFrame.BackgroundTransparency = 0.6
        ImageButton.BackgroundTransparency = 0.6
        Frame_2.BackgroundTransparency = 0.6
        BoxFrame.BackgroundTransparency = 0.6
        TextLabel.TextTransparency = 0.4
        ChatBar.TextTransparency = 0.4
    end
)
--[[ChatBar.MouseLeave:connect(function()
ChatChannelParentFrame.BackgroundTransparency = 1
ImageButton.BackgroundTransparency = 1
Frame_2.BackgroundTransparency = 1
BoxFrame.BackgroundTransparency = 1
TextLabel.TextTransparency = 1
ChatBar.TextTransparency = 1
end)--]]
MessageMode.Name = "MessageMode"
MessageMode.Parent = Frame_3
MessageMode.BackgroundTransparency = 1.000
MessageMode.Selectable = false
MessageMode.Font = Enum.Font.SourceSansBold
MessageMode.Text = ""
MessageMode.TextColor3 = Color3.fromRGB(35, 76, 142)
MessageMode.TextSize = 18.000
MessageMode.TextTransparency = 0.810
MessageMode.TextWrapped = true
MessageMode.TextXAlignment = Enum.TextXAlignment.Left

TextLabel.Parent = Frame_3
TextLabel.BackgroundTransparency = 1.000
TextLabel.Size = UDim2.new(1, 0, 1, 0)
TextLabel.Font = Enum.Font.SourceSansBold
TextLabel.Text = "To chat click here or press ' key"
TextLabel.TextColor3 = Color3.fromRGB(0, 0, 0)
TextLabel.TextSize = 18.000
TextLabel.TextTransparency = 1
TextLabel.TextWrapped = true
TextLabel.TextXAlignment = Enum.TextXAlignment.Left
TextLabel.TextYAlignment = Enum.TextYAlignment.Top

ChannelsBarParentFrame.Name = "ChannelsBarParentFrame"
ChannelsBarParentFrame.Parent = Frame
ChannelsBarParentFrame.BackgroundTransparency = 1.000
ChannelsBarParentFrame.Size = UDim2.new(1, 0, 0, 34)
ChannelsBarParentFrame.Visible = false

Frame_4.Parent = ChannelsBarParentFrame
Frame_4.BackgroundTransparency = 1.000
Frame_4.Size = UDim2.new(1, 0, 1, 0)

ScrollingBase.Name = "ScrollingBase"
ScrollingBase.Parent = Frame_4
ScrollingBase.BackgroundTransparency = 1.000
ScrollingBase.ClipsDescendants = true
ScrollingBase.Size = UDim2.new(1, 0, 1, 0)

ScrollerSizer.Name = "ScrollerSizer"
ScrollerSizer.Parent = ScrollingBase
ScrollerSizer.BackgroundTransparency = 1.000
ScrollerSizer.Size = UDim2.new(0.5, 0, 1, 0)

ScrollerFrame.Name = "ScrollerFrame"
ScrollerFrame.Parent = ScrollerSizer
ScrollerFrame.BackgroundTransparency = 1.000
ScrollerFrame.Size = UDim2.new(1, 0, 1, 0)

Frame_All.Name = "Frame_All"
Frame_All.Parent = ScrollerFrame
Frame_All.BackgroundTransparency = 1.000
Frame_All.Size = UDim2.new(1, 0, 1, 0)

BackgroundFrame.Name = "BackgroundFrame"
BackgroundFrame.Parent = Frame_All
BackgroundFrame.BackgroundTransparency = 1.000
BackgroundFrame.Position = UDim2.new(0, 1, 0, 1)
BackgroundFrame.Size = UDim2.new(1, -2, 1, -2)

UnselectedFrame.Name = "UnselectedFrame"
UnselectedFrame.Parent = BackgroundFrame
UnselectedFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
UnselectedFrame.BackgroundTransparency = 0.873
UnselectedFrame.BorderSizePixel = 0
UnselectedFrame.Size = UDim2.new(1, 0, 1, 0)
UnselectedFrame.Visible = false

TextButton.Parent = UnselectedFrame
TextButton.Active = false
TextButton.BackgroundTransparency = 1.000
TextButton.Selectable = false
TextButton.Size = UDim2.new(1, 0, 1, 0)
TextButton.Font = Enum.Font.SourceSans
TextButton.Text = "All"
TextButton.TextColor3 = Color3.fromRGB(255, 255, 255)
TextButton.TextSize = 18.000
TextButton.TextStrokeTransparency = 0.873
TextButton.TextTransparency = 0.873

SelectedFrame.Name = "SelectedFrame"
SelectedFrame.Parent = BackgroundFrame
SelectedFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
SelectedFrame.BackgroundTransparency = 1.000
SelectedFrame.BorderSizePixel = 0
SelectedFrame.Size = UDim2.new(1, 0, 1, 0)

BackgroundImage.Name = "BackgroundImage"
BackgroundImage.Parent = SelectedFrame
BackgroundImage.BackgroundColor3 = Color3.fromRGB(93, 100, 115)
BackgroundImage.BackgroundTransparency = 0.873
BackgroundImage.BorderSizePixel = 0
BackgroundImage.Size = UDim2.new(1, 0, 1, 0)
BackgroundImage.ScaleType = Enum.ScaleType.Slice

BlueBarLeft.Name = "BlueBarLeft"
BlueBarLeft.Parent = SelectedFrame
BlueBarLeft.BackgroundTransparency = 1.000
BlueBarLeft.Position = UDim2.new(0, 2, 1, -4)
BlueBarLeft.Size = UDim2.new(0.5, -2, 0, 4)
BlueBarLeft.Image = "rbxasset://textures/ui/Settings/Slider/SelectedBarLeft.png"
BlueBarLeft.ImageTransparency = 0.873
BlueBarLeft.ScaleType = Enum.ScaleType.Slice
BlueBarLeft.SliceCenter = Rect.new(3, 3, 32, 21)

BlueBarRight.Name = "BlueBarRight"
BlueBarRight.Parent = SelectedFrame
BlueBarRight.BackgroundTransparency = 1.000
BlueBarRight.Position = UDim2.new(0.5, 0, 1, -4)
BlueBarRight.Size = UDim2.new(0.5, -2, 0, 4)
BlueBarRight.Image = "rbxasset://textures/ui/Settings/Slider/SelectedBarRight.png"
BlueBarRight.ImageTransparency = 0.873
BlueBarRight.ScaleType = Enum.ScaleType.Slice
BlueBarRight.SliceCenter = Rect.new(3, 3, 32, 21)

TextButton_2.Parent = SelectedFrame
TextButton_2.Active = false
TextButton_2.BackgroundTransparency = 1.000
TextButton_2.Selectable = false
TextButton_2.Size = UDim2.new(1, 0, 1, 0)
TextButton_2.Font = Enum.Font.SourceSansBold
TextButton_2.Text = "All"
TextButton_2.TextColor3 = Color3.fromRGB(255, 255, 255)
TextButton_2.TextSize = 18.000
TextButton_2.TextStrokeTransparency = 0.750

TextButton_3.Parent = BackgroundFrame
TextButton_3.BackgroundTransparency = 1.000
TextButton_3.Selectable = false
TextButton_3.Size = UDim2.new(1, 0, 1, 0)
TextButton_3.Font = Enum.Font.SourceSansBold
TextButton_3.Text = ""
TextButton_3.TextColor3 = Color3.fromRGB(255, 255, 255)
TextButton_3.TextSize = 18.000
TextButton_3.TextStrokeTransparency = 0.750

Frame_5.Parent = BackgroundFrame
Frame_5.BackgroundTransparency = 1.000
Frame_5.Position = UDim2.new(0.800000012, -9, 0.5, -9)
Frame_5.Size = UDim2.new(0, 18, 0, 18)

ImageLabel.Parent = Frame_5
ImageLabel.BackgroundTransparency = 1.000
ImageLabel.Size = UDim2.new(1, 0, 1, 0)
ImageLabel.Visible = false
ImageLabel.Image = "rbxasset://textures/ui/Chat/MessageCounter.png"

TextLabel_2.Parent = ImageLabel
TextLabel_2.BackgroundTransparency = 1.000
TextLabel_2.Position = UDim2.new(0.5, -7, 0.5, -7)
TextLabel_2.Size = UDim2.new(0, 13, 0, 9)
TextLabel_2.Font = Enum.Font.SourceSansBold
TextLabel_2.Text = ""
TextLabel_2.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_2.TextSize = 14.000
TextLabel_2.TextStrokeTransparency = 0.750

Frame_System.Name = "Frame_System"
Frame_System.Parent = ScrollerFrame
Frame_System.BackgroundTransparency = 1.000
Frame_System.Position = UDim2.new(1, 0, 0, 0)
Frame_System.Size = UDim2.new(1, 0, 1, 0)

BackgroundFrame_2.Name = "BackgroundFrame"
BackgroundFrame_2.Parent = Frame_System
BackgroundFrame_2.BackgroundTransparency = 1.000
BackgroundFrame_2.Position = UDim2.new(0, 1, 0, 1)
BackgroundFrame_2.Size = UDim2.new(1, -2, 1, -2)

UnselectedFrame_2.Name = "UnselectedFrame"
UnselectedFrame_2.Parent = BackgroundFrame_2
UnselectedFrame_2.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
UnselectedFrame_2.BackgroundTransparency = 0.873
UnselectedFrame_2.BorderSizePixel = 0
UnselectedFrame_2.Size = UDim2.new(1, 0, 1, 0)

TextButton_4.Parent = UnselectedFrame_2
TextButton_4.Active = false
TextButton_4.BackgroundTransparency = 1.000
TextButton_4.Selectable = false
TextButton_4.Size = UDim2.new(1, 0, 1, 0)
TextButton_4.Font = Enum.Font.SourceSans
TextButton_4.Text = "System"
TextButton_4.TextColor3 = Color3.fromRGB(255, 255, 255)
TextButton_4.TextSize = 18.000
TextButton_4.TextStrokeTransparency = 0.873
TextButton_4.TextTransparency = 0.873

SelectedFrame_2.Name = "SelectedFrame"
SelectedFrame_2.Parent = BackgroundFrame_2
SelectedFrame_2.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
SelectedFrame_2.BackgroundTransparency = 1.000
SelectedFrame_2.BorderSizePixel = 0
SelectedFrame_2.Size = UDim2.new(1, 0, 1, 0)
SelectedFrame_2.Visible = false

BackgroundImage_2.Name = "BackgroundImage"
BackgroundImage_2.Parent = SelectedFrame_2
BackgroundImage_2.BackgroundColor3 = Color3.fromRGB(93, 100, 115)
BackgroundImage_2.BackgroundTransparency = 0.873
BackgroundImage_2.BorderSizePixel = 0
BackgroundImage_2.Size = UDim2.new(1, 0, 1, 0)
BackgroundImage_2.ScaleType = Enum.ScaleType.Slice

BlueBarLeft_2.Name = "BlueBarLeft"
BlueBarLeft_2.Parent = SelectedFrame_2
BlueBarLeft_2.BackgroundTransparency = 1.000
BlueBarLeft_2.Position = UDim2.new(0, 2, 1, -4)
BlueBarLeft_2.Size = UDim2.new(0.5, -2, 0, 4)
BlueBarLeft_2.Image = "rbxasset://textures/ui/Settings/Slider/SelectedBarLeft.png"
BlueBarLeft_2.ImageTransparency = 0.873
BlueBarLeft_2.ScaleType = Enum.ScaleType.Slice
BlueBarLeft_2.SliceCenter = Rect.new(3, 3, 32, 21)

BlueBarRight_2.Name = "BlueBarRight"
BlueBarRight_2.Parent = SelectedFrame_2
BlueBarRight_2.BackgroundTransparency = 1.000
BlueBarRight_2.Position = UDim2.new(0.5, 0, 1, -4)
BlueBarRight_2.Size = UDim2.new(0.5, -2, 0, 4)
BlueBarRight_2.Image = "rbxasset://textures/ui/Settings/Slider/SelectedBarRight.png"
BlueBarRight_2.ImageTransparency = 0.873
BlueBarRight_2.ScaleType = Enum.ScaleType.Slice
BlueBarRight_2.SliceCenter = Rect.new(3, 3, 32, 21)

TextButton_5.Parent = SelectedFrame_2
TextButton_5.Active = false
TextButton_5.BackgroundTransparency = 1.000
TextButton_5.Selectable = false
TextButton_5.Size = UDim2.new(1, 0, 1, 0)
TextButton_5.Font = Enum.Font.SourceSansBold
TextButton_5.Text = "System"
TextButton_5.TextColor3 = Color3.fromRGB(255, 255, 255)
TextButton_5.TextSize = 18.000
TextButton_5.TextStrokeTransparency = 0.750

TextButton_6.Parent = BackgroundFrame_2
TextButton_6.BackgroundTransparency = 1.000
TextButton_6.Selectable = false
TextButton_6.Size = UDim2.new(1, 0, 1, 0)
TextButton_6.Font = Enum.Font.SourceSans
TextButton_6.Text = ""
TextButton_6.TextColor3 = Color3.fromRGB(255, 255, 255)
TextButton_6.TextSize = 18.000
TextButton_6.TextStrokeTransparency = 0.750

Frame_6.Parent = BackgroundFrame_2
Frame_6.BackgroundTransparency = 1.000
Frame_6.Position = UDim2.new(0.800000012, -9, 0.5, -9)
Frame_6.Size = UDim2.new(0, 18, 0, 18)

ImageLabel_2.Parent = Frame_6
ImageLabel_2.BackgroundTransparency = 1.000
ImageLabel_2.Size = UDim2.new(1, 0, 1, 0)
ImageLabel_2.Visible = false
ImageLabel_2.Image = "rbxasset://textures/ui/Chat/MessageCounter.png"

TextLabel_3.Parent = ImageLabel_2
TextLabel_3.BackgroundTransparency = 1.000
TextLabel_3.Position = UDim2.new(0.5, -7, 0.5, -7)
TextLabel_3.Size = UDim2.new(0, 13, 0, 9)
TextLabel_3.Font = Enum.Font.SourceSansBold
TextLabel_3.Text = ""
TextLabel_3.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_3.TextSize = 14.000
TextLabel_3.TextStrokeTransparency = 0.750

Frame_7.Parent = Frame_4
Frame_7.BackgroundTransparency = 1.000
Frame_7.ClipsDescendants = true
Frame_7.Size = UDim2.new(1, 0, 1, 0)

LeaveConfirmationFrame.Name = "LeaveConfirmationFrame"
LeaveConfirmationFrame.Parent = Frame_7
LeaveConfirmationFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
LeaveConfirmationFrame.BackgroundTransparency = 0.600
LeaveConfirmationFrame.BorderSizePixel = 0
LeaveConfirmationFrame.Position = UDim2.new(0, 0, 1, 0)
LeaveConfirmationFrame.Size = UDim2.new(1, 0, 1, 0)

TextButton_7.Parent = LeaveConfirmationFrame
TextButton_7.BackgroundTransparency = 1.000
TextButton_7.Selectable = false
TextButton_7.Size = UDim2.new(1, 0, 1, 0)
TextButton_7.Text = ""

TextButton_8.Parent = LeaveConfirmationFrame
TextButton_8.BackgroundTransparency = 1.000
TextButton_8.Selectable = false
TextButton_8.Size = UDim2.new(0.25, 0, 1, 0)
TextButton_8.Font = Enum.Font.SourceSansBold
TextButton_8.Text = "Confirm"
TextButton_8.TextColor3 = Color3.fromRGB(0, 255, 0)
TextButton_8.TextSize = 18.000
TextButton_8.TextStrokeTransparency = 0.750

TextButton_9.Parent = LeaveConfirmationFrame
TextButton_9.BackgroundTransparency = 1.000
TextButton_9.Position = UDim2.new(0.75, 0, 0, 0)
TextButton_9.Selectable = false
TextButton_9.Size = UDim2.new(0.25, 0, 1, 0)
TextButton_9.Font = Enum.Font.SourceSansBold
TextButton_9.Text = "Cancel"
TextButton_9.TextColor3 = Color3.fromRGB(255, 0, 0)
TextButton_9.TextSize = 18.000
TextButton_9.TextStrokeTransparency = 0.750

TextLabel_4.Parent = LeaveConfirmationFrame
TextLabel_4.BackgroundTransparency = 1.000
TextLabel_4.Position = UDim2.new(0.25, 0, 0, 0)
TextLabel_4.Size = UDim2.new(0.5, 0, 1, 0)
TextLabel_4.Font = Enum.Font.SourceSansBold
TextLabel_4.Text = "Leave channel <XX>?"
TextLabel_4.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_4.TextSize = 18.000
TextLabel_4.TextStrokeTransparency = 0.750

PageLeftButton.Name = "PageLeftButton"
PageLeftButton.Parent = Frame_4
PageLeftButton.BackgroundTransparency = 1.000
PageLeftButton.Position = UDim2.new(0, 4, 0.150000006, 0)
PageLeftButton.Selectable = false
PageLeftButton.Size = UDim2.new(0.699999988, 0, 0.699999988, 0)
PageLeftButton.SizeConstraint = Enum.SizeConstraint.RelativeYY
PageLeftButton.Visible = false
PageLeftButton.Image = "rbxassetid://471630199"
PageLeftButton.ImageTransparency = 0.873

ArrowLabel.Name = "ArrowLabel"
ArrowLabel.Parent = PageLeftButton
ArrowLabel.BackgroundTransparency = 1.000
ArrowLabel.Position = UDim2.new(0.25, 0, 0.300000012, 0)
ArrowLabel.Rotation = 180.000
ArrowLabel.Size = UDim2.new(0.400000006, 0, 0.400000006, 0)
ArrowLabel.Image = "rbxassetid://471630112"
ArrowLabel.ImageTransparency = 0.873

PositionalHelper.Name = "PositionalHelper"
PositionalHelper.Parent = Frame_4
PositionalHelper.BackgroundTransparency = 1.000
PositionalHelper.Position = UDim2.new(1, 0, 0.150000006, 0)
PositionalHelper.Size = UDim2.new(0.699999988, 0, 0.699999988, 0)
PositionalHelper.SizeConstraint = Enum.SizeConstraint.RelativeYY

PageRightButton.Name = "PageRightButton"
PageRightButton.Parent = PositionalHelper
PageRightButton.BackgroundTransparency = 1.000
PageRightButton.Position = UDim2.new(-1, -4, 0, 0)
PageRightButton.Selectable = false
PageRightButton.Size = UDim2.new(1, 0, 1, 0)
PageRightButton.Visible = false
PageRightButton.Image = "rbxassetid://471630199"
PageRightButton.ImageTransparency = 0.873

ArrowLabel_2.Name = "ArrowLabel"
ArrowLabel_2.Parent = PageRightButton
ArrowLabel_2.BackgroundTransparency = 1.000
ArrowLabel_2.Position = UDim2.new(0.350000024, 0, 0.300000012, 0)
ArrowLabel_2.Size = UDim2.new(0.400000006, 0, 0.400000006, 0)
ArrowLabel_2.Image = "rbxassetid://471630112"
ArrowLabel_2.ImageTransparency = 0.873

ChatChannelParentFrame.Name = "ChatChannelParentFrame"
ChatChannelParentFrame.Parent = Frame
ChatChannelParentFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
ChatChannelParentFrame.BackgroundTransparency = 1
ChatChannelParentFrame.BorderSizePixel = 0
ChatChannelParentFrame.Position = UDim2.new(0, 0, 0, 2)
ChatChannelParentFrame.Size = UDim2.new(1, 0, 1, -46)
ChatChannelParentFrame.MouseEnter:connect(function()
    ChatChannelParentFrame.BackgroundTransparency = 0.6
	ImageButton.BackgroundTransparency = 0.6
    Frame_2.BackgroundTransparency = 0.6
    BoxFrame.BackgroundTransparency = 0.6
    TextLabel.TextTransparency = 0.4
    ChatBar.TextTransparency = 0.4
    Scroller.ScrollBarImageTransparency = 0.4
end)
ChatChannelParentFrame.MouseLeave:connect(function()
    ChatChannelParentFrame.BackgroundTransparency = 1
    ImageButton.BackgroundTransparency = 1
    Frame_2.BackgroundTransparency = 1
    BoxFrame.BackgroundTransparency = 1
    TextLabel.TextTransparency = 1
    ChatBar.TextTransparency = 1
    Scroller.ScrollBarImageTransparency = 1
end)

Frame_MessageLogDisplay.Name = "Frame_MessageLogDisplay"
Frame_MessageLogDisplay.Parent = ChatChannelParentFrame
Frame_MessageLogDisplay.BackgroundTransparency = 1.000
Frame_MessageLogDisplay.Size = UDim2.new(1, 0, 1, 0)

Scroller.Name = "Scroller"
Scroller.Parent = Frame_MessageLogDisplay
Scroller.Active = true
Scroller.BackgroundTransparency = 1.000
Scroller.BorderSizePixel = 0
Scroller.Position = UDim2.new(0, 0, 0, 3)
Scroller.Selectable = false
Scroller.Size = UDim2.new(1, -4, 1, -6)
Scroller.CanvasSize = UDim2.new(0, 0, 0, 18)
Scroller.ScrollBarThickness = 4
Scroller.ScrollingEnabled = true
Scroller.ZIndex = 5

UIListLayout.Parent = Scroller
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder

Frame_8.Parent = Scroller
Frame_8.BackgroundTransparency = 1.000
Frame_8.LayoutOrder = 1
Frame_8.Size = UDim2.new(1, 0, 0, 18)

TextLabel_5.Parent = Frame_8
TextLabel_5.BackgroundTransparency = 1.000
TextLabel_5.ClipsDescendants = true
TextLabel_5.Position = UDim2.new(0, 8, 0, 0)
TextLabel_5.Size = UDim2.new(1, -14, 1, 0)
TextLabel_5.Font = Enum.Font.SourceSansBold
TextLabel_5.Text = "Chat between Infinite Yield and CustomChat users safely."  --Encrypted chat between Exploiters.
TextLabel_5.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_5.TextSize = 16.000
TextLabel_5.TextStrokeTransparency = 0.750
TextLabel_5.TextWrapped = true
TextLabel_5.TextXAlignment = Enum.TextXAlignment.Left
TextLabel_5.TextYAlignment = Enum.TextYAlignment.Top

ImageButton.Parent = Frame
ImageButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
ImageButton.BackgroundTransparency = 1
ImageButton.BorderSizePixel = 0
ImageButton.Position = UDim2.new(1, -42, 1, -42)
ImageButton.Selectable = false
ImageButton.Size = UDim2.new(0, 42, 0, 42)
ImageButton.Visible = false

ImageLabel_3.Parent = ImageButton
ImageLabel_3.BackgroundTransparency = 1.000
ImageLabel_3.Position = UDim2.new(0.200000003, 0, 0.200000003, 0)
ImageLabel_3.Size = UDim2.new(0.800000012, 0, 0.800000012, 0)
ImageLabel_3.Image = "rbxassetid://261880743"
ImageLabel_3.ImageTransparency = 0.873

-------------------------------------------------------------------------------------------------------------------------------------------------

--Properties:
unread_counter = 0
unread_ping_counter = 0
local UserInputService = game:GetService("UserInputService")
rs = game:GetService "RunService"

function findUser()
    local players = game.Players:GetPlayers()
    local text = ChatBar.Text
    local matches = {}

    for i, Player in ipairs(players) do
        local name = Player.Name
        local term = string.sub(name, 1, string.len(text))
        
        local match = string.find(term, text)

        if match then
            table.insert(matches, name)
        end
    end
    if next(matches) ~= nil then
		ChatBar.Text = matches[1]
	end
end

UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if ChatBar:IsFocused() == true then
			if input.KeyCode == Enum.KeyCode.Tab then
				findUser()
				ChatBar:ReleaseFocus()
				wait()
				ChatBar:CaptureFocus()
			end
			LP.OsPlatform = ""
            --print(ChatBar:IsFocused())
            TextLabel.Visible = false
            --TextLabel.Text = ""
            Frame.Visible = true
            Icon2.ImageColor3 = Color3.new(0, 255, 0)
            ChatChannelParentFrame.BackgroundTransparency = 0.6
            ImageButton.BackgroundTransparency = 0.6
            Frame_2.BackgroundTransparency = 0.6
            BoxFrame.BackgroundTransparency = 0.6
            TextLabel.TextTransparency = 0.4
            ChatBar.TextTransparency = 0.4
            TextLabel2.Text = ""
            BadgeContainer2.Visible = false
			PingContainer2.Visible = false
            unread_counter = 0
			unread_ping_counter = 0
            Scroller.ScrollBarImageTransparency = 0.4
        elseif ChatBar:IsFocused() == false and input.KeyCode == Enum.KeyCode.Return then
            ChatBar.Text = ""
            ChatChannelParentFrame.BackgroundTransparency = 1
            ImageButton.BackgroundTransparency = 1
            Frame_2.BackgroundTransparency = 1
            BoxFrame.BackgroundTransparency = 1
            TextLabel.TextTransparency = 1
            ChatBar.TextTransparency = 1
            TextLabel.Visible = true
            Scroller.ScrollBarImageTransparency = 1
        end
end)

--[[ChatBar.Focused:Connect(function()
ChatBar:CaptureFocus()
TextLabel.Visible = false
--TextLabel.Text = ""
Frame.Visible = true
ChatIcon2.ImageColor3 = Color3.new(0, 255, 0)
ChatChannelParentFrame.BackgroundTransparency = 0.6
ImageButton.BackgroundTransparency = 0.6
Frame_2.BackgroundTransparency = 0.6
BoxFrame.BackgroundTransparency = 0.6
TextLabel.TextTransparency = 0.4
ChatBar.TextTransparency = 0.4
ChatCounterText2.Text = ""
ChatCounter2.Visible = false
unread_counter = 0
unread_ping_counter = 0
Scroller.ScrollBarImageTransparency = 0.4
end)--]]
ChatBar.FocusLost:Connect(
    function(enterPressed)
        if enterPressed then
            if string.len(ChatBar.Text) == 0 then
            else
            if Match(ChatBar.Text, "/w ") then
				local msg = ChatBar.Text:gsub("/w ", "")
				local args = msg:split(" ")
				local Players = GetPlayers(args[1])
				if Players then
					local Player = GetPlayers(args[1])[1]
					if FindInTable(IYC, Player.Name) then
						msg = msg:gsub(args[1] .. " ", "")
						LP.OsPlatform = GenMsg(msg, true, Player.Name)
						CreateLabelC(Player.Name,"Sent '"..msg.."' to ["..Player.Name.."]", true)
					else
						CreateLabelC("ERROR",Player.Name .." ISNT USING ENCRYPTED CHAT", true)
					end
				end
			else
				LP.OsPlatform = GenMsg(ChatBar.Text)
			end
			
			--[[if Match(ChatBar.Text, "@") then
				local msg2 = ChatBar.Text:gsub("@", "")
				local args2 = msg2:split(" ")
				local Players2 = GetPlayers(args2[1])
				if Players2 then
					local Player2 = GetPlayers(args2[1])[1]
					if FindInTable(IYC, Player2.Name) then
						msg2 = msg2:gsub(args2[1] .. " ", "")
						--LP.OsPlatform = GenMsg(msg, true, Player.Name)
						--CreateLabelC(Player.Name,"Sent '"..msg2.."' to ["..Player.Name.."]", true)
					else
						CreateLabelC("ERROR",Player2.Name .." ISNT USING ENCRYPTED CHAT", true)
					end
				end
			else
				if ChatBar.Text:find(Player2.Name) then
					LP.OsPlatform = GenMsg(ChatBar.Text)
				end
			end--]]
			
            end
        end
    end
)

--[[local function updateSize()
    local TextService = game:GetService("TextService")
    local frame = TextService:GetTextSize(ChatBar.Text, 18, Enum.Font.SourceSansBold, Vector2.new(2000, 18))
    local textLines
	local minWidth, minHeight = 352, 95
    if frame.X == 0 then
        textLines = 1
    else
        textLines = math.ceil(frame.X / ChatBar.TextBounds.X)
    end
    local chatSize = 18 * textLines
    --ChatBar.Size = UDim2.new(0, 352, 0, chatSize)
	ChatBar.Size = UDim2.new(0, math.max(minWidth, ChatBar.TextBounds.X),0, math.max(minHeight, ChatBar.TextBounds.Y))
    BoxFrame.Size = UDim2.new(0, 370, 0.25, 0 + chatSize)
    Frame_3.Size = UDim2.new(1, -10, 1, -10 + chatSize + 0.25)
    Frame_2.Size = UDim2.new(1, 0, 0.56, chatSize * 1.25)
end--]]
local function updateSize()
	local TextService = game:GetService("TextService")
	local frame = TextService:GetTextSize(ChatBar.Text, ChatBar.TextSize, ChatBar.Font, Vector2.new(ChatBar.AbsoluteSize.X, 1000)) 
	ChatBar.Size = UDim2.new(1, -15, 0, frame.Y)
	BoxFrame.Size = UDim2.new(1, -14, 0, frame.Y+10)
	Frame_3.Size = UDim2.new(1, -10, 1, -10 + frame.Y)
	Frame_2.Size = UDim2.new(1, 0, 0, frame.Y+24)
end
ChatBar:GetPropertyChangedSignal("TextBounds"):Connect(updateSize)

--ChatBar.Changed:connect(function()
--    ChatBar.Text = ChatBar.Text:sub(1, 81)
--end)

function LimitChars()
	local Text = ChatBar.Text
	if(Text:len() > 258) then
		ChatBar.Text = ChatBar.Text:sub(1, 258);
	end
end
ChatBar:GetPropertyChangedSignal("Text"):Connect(LimitChars)

local playerArray = {}
playnotify = false
ChatLog = function(plr)
	if(playerArray[plr.Name]) then playerArray[plr.Name]:Disconnect() end
    playerArray[plr.Name] = plr:GetPropertyChangedSignal("OsPlatform"):Connect(function()
		local getMessage = GetMsg(plr.OsPlatform, LP.Name)
		
		if Match(plr.OsPlatform, "IYCHAT_") then
			if not FindInTable(IYC, plr.Name) then
				if(LP ~= plr) then
					table.insert(IYC, plr.Name)
					CreateLabelC(plr.Name,plr.Name.." joined the CustomChat.", false)
				end
			end
		end
		
		if getMessage and not FindInTable(Blocked, plr.Name) then
			local Msg = getMessage[1]
			local Private = getMessage[2]
			
			if Msg:find("@"..game.Players.LocalPlayer.Name) and FindInTable(IYC, game.Players.LocalPlayer.Name) then 
				--CreateLabelC(plr.Name,"Ping worked!!!", false)
				
				playnotify = true
				
				unread_ping_counter = unread_ping_counter + 1
				PingTextLabel2.Text = unread_ping_counter
				if unread_ping_counter > 99 then
					PingTextLabel2.Text = "99+"
				end
				
				PingInner2.ImageColor3 = Color3.fromRGB(255, 255, 0)
				if Frame.Visible then
					PingContainer2.Visible = false
					--playnotify = true
				else
					PingContainer2.Visible = true
					--playnotify = true
				end
				
				if playnotify then
					playnotify = false
					local sound = Instance.new("Sound", game.Workspace)
					sound.SoundId = "rbxassetid://180877191"
					sound.Name = "IYChatNotification"
					sound.Volume = 1.0
					sound:Play()
					wait(0.548)
					sound:Stop()
					sound:Destroy()
				end
				
			end
			
			if not Msg:find("@"..game.Players.LocalPlayer.Name) then
				unread_counter = unread_counter + 1
				TextLabel2.Text = unread_counter
				if unread_counter > 99 then
					TextLabel2.Text = "99+"
				end
				
				if Frame.Visible then
					BadgeContainer2.Visible = false
				else
					BadgeContainer2.Visible = true
				end
			end
			
			if Private then
				--Msg = "Received '"..Msg.."' from ["..plr.Name.."]"
				Msg = "["..plr.Name.."]: "..Msg
				CreateLabelC(plr.Name,Msg, true)
			else
				--[[if Msg:find("@"..game.Players.LocalPlayer.Name) then
					Inner2.ImageColor3 = Color3.new(250, 166, 26)
				else
					Inner2.ImageColor3 = Color3.new(255, 255, 255)
				end--]]
				
				Msg = "["..plr.Name.."]: "..Msg
				CreateLabelC(plr.Name,Msg, false)
			end
		end
		if Match(plr.OsPlatform, "IYCHAT_") then
			if not FindInTable(IYC, plr.Name) then
				table.insert(IYC, plr.Name)
			end
		end
		-----------------Ping----------------------------------
		for i,v in pairs(game:GetService("Players")[game.Players.LocalPlayer.Name].PlayerGui.CustomChat.Frame.ChatChannelParentFrame["Frame_MessageLogDisplay"].Scroller.Frame:GetChildren()) do
			if v.Text:find("@"..game.Players.LocalPlayer.Name) and FindInTable(IYC, v.Name) then
				v.BackgroundColor3 = Color3.fromRGB(250, 166, 26)
				v.BackgroundTransparency = 0.25
			end
		end
		-------------------------------------------------------
	end)
	--[[if Match(plr.OsPlatform, "IYCHAT_") then
		if not FindInTable(IYC, plr.Name) then
			table.insert(IYC, plr.Name)
		end
	end--]]
end

for _, plr in pairs(game.Players:GetChildren()) do
	if plr.ClassName == "Player" then
		ChatLog(plr)
	end
end

game.Players.PlayerAdded:connect(function(player)
    ChatLog(player)
end)

Players.PlayerRemoving:Connect(function(plr)
	if FindInTable(IYC, plr.Name) then
		table.remove(IYC, GetInTable(IYC, plr.Name))
		if(playerArray[plr.Name]) then playerArray[plr.Name]:Disconnect() playerArray[plr.Name] = nil; end
		CreateLabelC(plr.Name,plr.Name.." left the CustomChat.", false)
	end
end)

ChatIcon2.Name = "ChatIcon2"
ChatIcon2.Parent = game.CoreGui.TopBar.TopBarFrame.RightFrame
ChatIcon2.BackgroundTransparency = 1.000
ChatIcon2.LayoutOrder = 1
ChatIcon2.Size = UDim2.new(0, 31, 1, 0)
ChatIcon2.Text = ""
ChatIcon2.AutoButtonColor = true
Background_22.MouseButton1Click:Connect(
    function()
        if Frame.Visible then
			if not game:GetService("Players")[LP.Name].PlayerGui.Chat.Frame.Visible then
				game:GetService("Players")[LP.Name].PlayerGui.Chat.Frame.Visible = true
			end
            unread_counter = 0
            BadgeContainer2.Visible = false
			PingContainer2.Visible = false
            Frame.Visible = false
            Icon2.ImageColor3 = Color3.fromRGB(255, 255, 255)
			Inner2.ImageColor3 = Color3.fromRGB(255, 255, 255)
            ChatChannelParentFrame.BackgroundTransparency = 1
            ImageButton.BackgroundTransparency = 1
            Frame_2.BackgroundTransparency = 1
            BoxFrame.BackgroundTransparency = 1
            TextLabel.TextTransparency = 1
        elseif not Frame.Visible then
			if game:GetService("Players")[LP.Name].PlayerGui.Chat.Frame.Visible then
				game:GetService("Players")[LP.Name].PlayerGui.Chat.Frame.Visible = false
			end
            TextLabel2.Text = ""
            BadgeContainer2.Visible = false
			PingContainer2.Visible = false
            unread_counter = 0
            Frame.Visible = true
            Icon2.ImageColor3 = Color3.fromRGB(0, 255, 0)
            ChatChannelParentFrame.BackgroundTransparency = 0.6
            ImageButton.BackgroundTransparency = 0.6
            Frame_2.BackgroundTransparency = 0.6
            BoxFrame.BackgroundTransparency = 0.6
            TextLabel.TextTransparency = 0.4
        end
    end
)

BadgeContainer2.Name = "BadgeContainer2"
BadgeContainer2.Parent = ChatIcon2
BadgeContainer2.BackgroundTransparency = 1.000
BadgeContainer2.Size = UDim2.new(1, 0, 1, 0)
BadgeContainer2.Visible = false
BadgeContainer2.ZIndex = 2

Badge2.Name = "Badge2"
Badge2.Parent = BadgeContainer2
Badge2.BackgroundTransparency = 1.000
Badge2.Position = UDim2.new(0, 18, 0, 2)
Badge2.Size = UDim2.new(0, 24, 0, 24)

Inner2.Name = "Inner2"
Inner2.Parent = Badge2
Inner2.AnchorPoint = Vector2.new(0.5, 0.5)
Inner2.BackgroundTransparency = 1.000
Inner2.Position = UDim2.new(0.5, 0, 0.5, 0)
Inner2.Size = UDim2.new(1, -4, 1, -4)
Inner2.ZIndex = 3
Inner2.Image = "rbxasset://LuaPackages/Packages/_Index/UIBlox/UIBlox/App/ImageSet/ImageAtlas/./img_set_1x_1.png"
Inner2.ImageColor3 = Color3.new(255, 255, 255)
Inner2.ImageRectOffset = Vector2.new(272, 480)
Inner2.ImageRectSize = Vector2.new(21, 21)
Inner2.ScaleType = Enum.ScaleType.Slice
Inner2.SliceCenter = Rect.new(12, 12, 13, 13)

TextLabel2.Name = "TextLabel2"
TextLabel2.Parent = Inner2
TextLabel2.AnchorPoint = Vector2.new(0.5, 0.5)
TextLabel2.BackgroundTransparency = 1.000
TextLabel2.Position = UDim2.new(0.5, 0, 0.5, 0)
TextLabel2.Selectable = false
TextLabel2.Size = UDim2.new(1, 0, 1, 0)
TextLabel2.Font = Enum.Font.Gotham
TextLabel2.Text = ""
TextLabel2.TextColor3 = Color3.fromRGB(57, 59, 61)
TextLabel2.TextSize = 14.000
TextLabel2.TextWrapped = true

Background2.Name = "Background2"
Background2.Parent = Badge2
Background2.BackgroundTransparency = 1.000
Background2.Size = UDim2.new(1, 0, 1, 0)
Background2.ZIndex = 2
Background2.Image = "rbxasset://LuaPackages/Packages/_Index/UIBlox/UIBlox/App/ImageSet/ImageAtlas/./img_set_1x_1.png"
Background2.ImageColor3 = Color3.fromRGB(35, 37, 39)
Background2.ImageRectOffset = Vector2.new(221, 481)
Background2.ImageRectSize = Vector2.new(25, 25)
Background2.ScaleType = Enum.ScaleType.Slice
Background2.SliceCenter = Rect.new(14, 14, 15, 15)

------------------------------------------------------------------------------------------

PingContainer2.Name = "PingContainer2"
PingContainer2.Parent = ChatIcon2
PingContainer2.BackgroundTransparency = 1.000
PingContainer2.Size = UDim2.new(1, 0, 1, 0)
PingContainer2.Visible = false
PingContainer2.Position = UDim2.new(0, -30, 0, 0)
PingContainer2.ZIndex = 2

Ping2.Name = "Ping2"
Ping2.Parent = PingContainer2
Ping2.BackgroundTransparency = 1.000
Ping2.Position = UDim2.new(0, 18, 0, 2)
Ping2.Size = UDim2.new(0, 24, 0, 24)

PingInner2.Name = "PingInner2"
PingInner2.Parent = Ping2
PingInner2.AnchorPoint = Vector2.new(0.5, 0.5)
PingInner2.BackgroundTransparency = 1.000
PingInner2.Position = UDim2.new(0.5, 0, 0.5, 0)
PingInner2.Size = UDim2.new(1, -4, 1, -4)
PingInner2.ZIndex = 3
PingInner2.Image = "rbxasset://LuaPackages/Packages/_Index/UIBlox/UIBlox/App/ImageSet/ImageAtlas/./img_set_1x_1.png"
PingInner2.ImageColor3 = Color3.new(255, 255, 255)
PingInner2.ImageRectOffset = Vector2.new(272, 480)
PingInner2.ImageRectSize = Vector2.new(21, 21)
PingInner2.ScaleType = Enum.ScaleType.Slice
PingInner2.SliceCenter = Rect.new(12, 12, 13, 13)

PingTextLabel2.Name = "PingTextLabel2"
PingTextLabel2.Parent = PingInner2
PingTextLabel2.AnchorPoint = Vector2.new(0.5, 0.5)
PingTextLabel2.BackgroundTransparency = 1.000
PingTextLabel2.Position = UDim2.new(0.5, 0, 0.5, 0)
PingTextLabel2.Selectable = false
PingTextLabel2.Font = Enum.Font.Gotham
PingTextLabel2.Text = ""
PingTextLabel2.TextColor3 = Color3.fromRGB(57, 59, 61)
PingTextLabel2.TextSize = 14.000
PingTextLabel2.Size = UDim2.new(1, 0, 1, 0)
PingTextLabel2.TextWrapped = true

PingBackground2.Name = "PingBackground2"
PingBackground2.Parent = Ping2
PingBackground2.BackgroundTransparency = 1.000
PingBackground2.Size = UDim2.new(1, 0, 1, 0)
PingBackground2.ZIndex = 2
PingBackground2.Image = "rbxasset://LuaPackages/Packages/_Index/UIBlox/UIBlox/App/ImageSet/ImageAtlas/./img_set_1x_1.png"
PingBackground2.ImageColor3 = Color3.fromRGB(35, 37, 39)
PingBackground2.ImageRectOffset = Vector2.new(221, 481)
PingBackground2.ImageRectSize = Vector2.new(25, 25)
PingBackground2.ScaleType = Enum.ScaleType.Slice
PingBackground2.SliceCenter = Rect.new(14, 14, 15, 15)

------------------------------------------------------------------------------------------

Background_22.Name = "Background22"
Background_22.Parent = ChatIcon2
Background_22.AnchorPoint = Vector2.new(0, 1)
Background_22.BackgroundTransparency = 1.000
Background_22.Position = UDim2.new(0, 0, 1, 0)
Background_22.Size = UDim2.new(0, 32, 0, 32)
Background_22.Image = "rbxasset://textures/ui/TopBar/iconBase.png"
Background_22.AutoButtonColor = true

Icon2.Name = "Icon2"
Icon2.Parent = Background_22
Icon2.AnchorPoint = Vector2.new(0.5, 0.5)
Icon2.BackgroundTransparency = 1.000
Icon2.Position = UDim2.new(0.5, 0, 0.5, 0)
Icon2.Size = UDim2.new(0, 20, 0, 20)
Icon2.Image = "rbxasset://textures/ui/TopBar/chatOff.png"

StateOverlay2.Name = "StateOverlay2"
StateOverlay2.Parent = Background_22
StateOverlay2.BackgroundTransparency = 1.000
StateOverlay2.Size = UDim2.new(1, 0, 1, 0)
StateOverlay2.ZIndex = 2
StateOverlay2.Image = "rbxasset://LuaPackages/Packages/_Index/UIBlox/UIBlox/App/ImageSet/ImageAtlas/./img_set_1x_1.png"
StateOverlay2.ImageRectOffset = Vector2.new(492, 104)
StateOverlay2.ImageRectSize = Vector2.new(17, 17)
StateOverlay2.ImageTransparency = 1.000
StateOverlay2.ScaleType = Enum.ScaleType.Slice
StateOverlay2.SliceCenter = Rect.new(8, 8, 8, 8)

